<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>AI„Ç§„É©„Çπ„ÉàÁî® „Ç∑„Éû„Éì„É´„ÉÄ„ÉºüïäÔ∏è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* --- „Éô„Éº„Çπ„Éá„Ç∂„Ç§„É≥ --- */
    :root {
      --primary-color: #4a90e2; /* „Ç¢„ÇØ„Çª„É≥„Éà„Ç´„É©„ÉºÔºàÈùíÔºâ */
      --accent-gradient: linear-gradient(90deg, #a9e3ff 0%, #ffffff 45%, #e7f3ff 70%, #f2f5ff 100%);
      --bg-color: #f4f6f9;      /* ÂÖ®‰Ωì„ÅÆËÉåÊôØËâ≤ */
      --card-bg: #ffffff;       /* „Ç´„Éº„Éâ„ÅÆËÉåÊôØËâ≤ */
      --text-color: #333;
      --border-radius: 8px;
    }

    body { 
      font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif; 
      margin: 0; 
      padding: 0 0 300px 0; /* „Éï„ÉÉ„Çø„ÉºÂàÜ„ÅÆ‰ΩôÁôΩ */
      background: var(--bg-color); 
      color: var(--text-color);
    }

    /* --- „Éò„ÉÉ„ÉÄ„Éº --- */
    header {
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(234,246,255,0.78));
padding: 20px 0;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 15px;
      border-bottom: 1px solid #eaeaea;
    }

    
    /* --- „Ç∑„Éû„Ç®„Éä„Ç¨Ôºö‰∏äÂìÅ„Å™ÁæΩ„ÅÆÊ∞óÈÖçÔºàÊìç‰Ωú„ÇíÈÇ™È≠î„Åó„Å™„ÅÑËÉåÊôØ„Ç®„Éï„Çß„ÇØ„ÉàÔºâ --- */
    header::before{
      content:"";
      position:absolute;
      inset:-20px;
      pointer-events:none;
      opacity:0.14;
      background-repeat: repeat;
      background-size: 220px 220px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cg fill='none' stroke='%2386d0ff' stroke-opacity='0.55' stroke-width='2'%3E%3Cpath d='M40 170 C70 140 100 115 150 85 C120 100 90 125 60 160'/%3E%3Cpath d='M55 165 C85 135 115 110 165 80'/%3E%3Cpath d='M70 160 C96 136 128 108 178 74'/%3E%3Cpath d='M120 150 C140 130 160 118 190 95 C168 108 150 123 130 144'/%3E%3C/g%3E%3Cg fill='none' stroke='%23ffffff' stroke-opacity='0.55' stroke-width='1.5'%3E%3Cpath d='M38 172 C68 142 98 117 148 87'/%3E%3Cpath d='M118 152 C140 132 160 120 188 98'/%3E%3C/g%3E%3C/svg%3E");
      filter: blur(0.2px);
      transform: translateY(-6px);
    }
h1 { 
      font-size: 1.8em; 
      margin: 0; 
      font-weight: 800;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      color: #333;
    }

    .title-text {
  /* Snowy gradient but readable on white */
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;

  letter-spacing: 0.065em;
  font-weight: 880;

  /* Contrast helpers (keeps elegance) */
  -webkit-text-stroke: 0.6px rgba(30,36,48,0.28);
  text-shadow:
    0 2px 10px rgba(30,36,48,0.16),
    0 1px 0 rgba(255,255,255,0.65);
}    .title-icon {
      font-size: 1.2em;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }

    .subtitle {
      font-size: 0.75em; color: #888; margin-top: 5px; letter-spacing: 0.1em; font-weight: bold; text-transform: uppercase;
    }

    .container { max-width: 1000px; margin: 0 auto; padding: 0 10px; }

    /* --- „É≠„Ç∞„Ç®„É™„Ç¢ --- */
    #log-wrapper { 
      margin-bottom: 12px; 
      background: var(--card-bg);
      padding: 8px 12px;
      border-radius: var(--border-radius);
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      border: 1px solid #e0e0e0;
    }
    .log-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .meter { display: inline-block; margin-right: 8px; font-size: 0.8em; padding: 3px 10px; border-radius: 12px; font-weight: bold; }
    .success { background: #d4edda; color: #155724; }
    .fail { background: #f8d7da; color: #721c24; }
    
    #log { 
      white-space: pre-wrap; font-family: Consolas, monospace; font-size: 0.85em; 
      background: #2d2d2d; color: #e0e0e0; padding: 8px; 
      border-radius: 4px; max-height: 100px; overflow-y: auto; 
      border: 1px solid #444;
    }

    /* --- „Çª„ÇØ„Ç∑„Éß„É≥ÔºàÂ§ßÊû†Ôºâ --- */
    .section { 
      background: var(--card-bg);
      margin-bottom: 12px; 
      border-radius: var(--border-radius);
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      border: 1px solid #e0e0e0;
      overflow: hidden;
    }

    /* ‚òÖ Â§ßË¶ãÂá∫„Åó„ÅÆ„Éá„Ç∂„Ç§„É≥ („Åì„Åì„ÇíÂº∑Ë™ø) */
    /* builder_core.v1.js „Åß‰ªò‰∏é„Åï„Çå„Çã .section-summary „ÇØ„É©„Çπ */
    summary.section-summary {
      background: #f8f9fa; /* ËñÑ„ÅÑ„Ç∞„É¨„Éº */
      padding: 14px 18px;
      font-size: 1.2em;    /* ÊñáÂ≠óÂ§ß„Åç„Åè */
      font-weight: bold;
      color: #2c3e50;      /* ÊøÉ„ÅÑËâ≤ */
      cursor: pointer;
      list-style: none;
      border-bottom: 1px solid transparent;
      transition: background 0.2s;
      border-left: 5px solid var(--primary-color); /* Â∑¶„Å´Èùí„ÅÑ„É©„Ç§„É≥„ÅßÂº∑Ë™ø */
      display: flex;
      align-items: center;
    }
    summary.section-summary:hover { background: #eef2f6; }
    
    details[open] > summary.section-summary {
      background: #e6f0ff; /* Èñã„ÅÑ„Åü„Å®„Åç„ÅØËñÑ„ÅÑÈùí */
      border-bottom: 1px solid #e0e0e0;
      color: #0056b3;
    }
    /* „Éá„Éï„Ç©„É´„Éà„ÅÆ‰∏âËßí„Éû„Éº„Ç´„Éº„ÇíÊ∂à„Åô */
    summary::-webkit-details-marker { display: none; }


    /* --- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ --- */
    .section-content {
      padding: 12px; 
    }

    /* ‚òÖ Â∞èË¶ãÂá∫„ÅóÔºà„Ç´„ÉÜ„Ç¥„É™Ôºâ„ÅÆ„Éá„Ç∂„Ç§„É≥ („Åì„Åì„ÇíÊéß„Åà„ÇÅ„Å´) */
    .section-content details {
      margin-bottom: 6px;
      border: 1px solid #eee;
      border-radius: 6px;
      background: #fff;
    }
    .section-content details[open] {
      background: #fff;
      border-color: #d0d7de;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* Èñã„ÅÑ„ÅüÊôÇ„Å´Â∞ë„ÅóÊµÆ„Åã„Åô */
    }

    .section-content summary {
      font-size: 0.95em; /* Â§ßË¶ãÂá∫„Åó„Çà„ÇäÂ∞è„Åï„Åè */
      padding: 8px 12px;
      cursor: pointer;
      color: #555;
      background: #fafafa;
      border-radius: 6px;
      font-weight: 600;
      transition: 0.2s;
      display: flex;
      align-items: center;
      list-style: none; /* „Éá„Éï„Ç©„É´„Éà„Éû„Éº„Ç´„ÉºÂâäÈô§ */
    }
    .section-content summary:hover { background: #f0f0f0; }

    /* Â∞èË¶ãÂá∫„ÅóÁî®„ÅÆ„Ç´„Çπ„Çø„É†„Ç¢„Ç§„Ç≥„É≥ (CSS„ÅßÁîüÊàê) */
    .section-content summary::before {
      content: "‚ñ∂";
      font-size: 0.7em;
      color: #999;
      margin-right: 8px;
      transition: transform 0.2s;
      display: inline-block;
    }
    /* Èñã„ÅÑ„ÅüÊôÇ„Å´„Ç¢„Ç§„Ç≥„É≥„ÇíÂõûËª¢ */
    .section-content details[open] > summary::before {
      transform: rotate(90deg);
      color: var(--primary-color);
    }
    
    .section-content details[open] > summary {
      background: #fff;
      color: #333;
      border-bottom: 1px solid #eee;
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }
    /* Â∞èË¶ãÂá∫„Åó„ÅÆ„Éá„Éï„Ç©„É´„Éà„Éû„Éº„Ç´„Éº„ÇíÊ∂à„Åô */
    .section-content summary::-webkit-details-marker { display: none; }


    /* --- „Ç∞„É™„ÉÉ„Éâ„É¨„Ç§„Ç¢„Ç¶„Éà --- */
    .section-content details[open] > div,
    .expression-v2-complete details[open] > div, 
    .pose-v2-latest details[open] > div,
    .attire-v1-ultimate-revised details[open] > div,
    .quality-preset-v1-ultimate details[open] > div,
    .lighting-v1 details[open] > div,
    .effect-v1 details[open] > div {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 6px;
      padding: 10px;
    }

    
/* --- FIX: Shima-enaga Collection left-gap on mobile ---
   The global rule `.attire-v1-ultimate-revised details[open] > div { display:grid; ... }`
   unintentionally turns the Shima grouped top-level body into a grid, creating empty right space.
   Force the top-level shima grouped body to be a normal block flow, while keeping inner panels intact.
*/
.attire-v1-ultimate-revised details.shima-grouped[open] > .shima-grouped-body{
  display:block !important;
  width:100% !important;
  box-sizing:border-box;
}
.attire-v1-ultimate-revised details.shima-grouped[open] > .shima-grouped-body > .shima-panels{
  display:block !important;
  width:100% !important;
  box-sizing:border-box;
}
/* ÂÄãÂà•„Çø„Ç∞Ôºà„É©„Éô„É´Ôºâ */
    #sections label {
      display: flex;
      align-items: center;
      padding: 6px 8px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9em;
      cursor: pointer;
      transition: all 0.15s;
      line-height: 1.3;
      min-height: 32px;
    }

    #sections label:hover {
      border-color: var(--primary-color);
      background: #f0f8ff;
      box-shadow: 0 2px 5px rgba(74, 144, 226, 0.15);
      transform: translateY(-1px);
    }

    /* „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ */
    #sections input[type="checkbox"] {
      accent-color: var(--primary-color);
      transform: scale(1.2);
      margin-right: 8px;
      flex-shrink: 0;
    }

    /* „ÉÅ„Çß„ÉÉ„ÇØ„Åï„Çå„ÅüÁä∂ÊÖã */
    #sections label:has(input:checked) {
      background: #e7f3ff;
      border-color: var(--primary-color);
      font-weight: bold;
      color: #0056b3;
      box-shadow: inset 0 0 0 1px var(--primary-color);
    }

    /* --- „Éó„É¨„Éì„É•„Éº„Ç®„É™„Ç¢ --- */
    #preview-area {
      border-radius: var(--border-radius);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      margin-bottom: 10px;
      border: 1px solid #ddd;
    }

    /* --- Âõ∫ÂÆö„Éï„ÉÉ„Çø„Éº --- */
    #mini-ui-fixed {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(8px);
      border-top: 1px solid #ccc;
      padding: 12px 16px 20px 16px;
      box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.08);
      z-index: 9999;
      box-sizing: border-box;
    }
    #actions { 
      display: flex; 
      gap: 10px; 
      margin-bottom: 10px; 
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }
    
    button { 
      flex: 1; 
      padding: 10px; 
      font-size: 1em; 
      border: none; 
      border-radius: 6px; 
      cursor: pointer; 
      font-weight: bold; 
      transition: 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    button:active { transform: translateY(1px); box-shadow: none; }

    #genBtn { background: linear-gradient(135deg, #4a90e2, #357abd); color: white; }
    #genBtn:hover { opacity: 0.9; }
    
    #copyBtn { background: #6c757d; color: white; }
    #copyBtn:hover { background: #5a6268; }
    
    #translateBtn { background: #ff9800; color: white; }
    #translateBtn:hover { background: #e68a00; }

    #resetBtn { background: #dc3545; color: white; }
    #resetBtn:hover { background: #c82333; }

    .reload-btn {
      padding: 4px 10px;
      font-size: 0.85em;
      margin-left: 8px;
      background: #fff;
      color: #333;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .reload-btn:hover { background: #f0f0f0; }

    textarea#out {
      width: 100%;
      height: 60px;
      padding: 10px;
      font-family: Consolas, monospace;
      font-size: 0.95em;
      border: 1px solid #ccc;
      border-radius: 6px;
      resize: none;
      background: #fff;
      box-sizing: border-box;
      max-width: 1000px;
      display: block;
      margin: 0 auto;
    }
    textarea#out:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
    }
  
/* --- Log fullscreen toggle --- */
#log-wrapper.fullscreen{
  position: fixed !important;
  inset: 0 !important;
  z-index: 99999 !important;
  background: #fff !important;
  padding: 10px !important;
  box-shadow: none !important;
  border-radius: 0 !important;
}
#log-wrapper.fullscreen #log{
  height: calc(100vh - 80px) !important;
  max-height: none !important;
}
body.log-fullscreen{
  overflow: hidden !important;
}
    .dev-only{ display:none !important; }

    /* --- Loading UI (User Mode) --- */
    #loading-wrapper{
      background:#fff;
      border:1px solid #eaeaea;
      border-radius:10px;
      padding:12px 14px;
      margin: 0 0 12px 0;
      box-shadow:0 2px 10px rgba(0,0,0,0.05);
    }
    .progress-outer{
      height:10px;
      background:#eef2f7;
      border-radius:999px;
      overflow:hidden;
      margin:8px 0;
    }
    .progress-inner{
      height:100%;
      background: var(--accent-gradient);
      border-radius:999px;
      transition: width 0.18s ease;
    }
    .loading-title{ font-weight:800; }
    .loading-text{ font-size:0.9em; opacity:0.85; }


    /* === ShimaBuilder Theme 1: Snowfield (safe decorative) === */
    :root{
      --shima-ice-1:#f7fbff;
      --shima-ice-2:#eaf4ff;
      --shima-sky:#cfe8ff;
      --shima-ink:#1e2430;
      --shima-shadow: rgba(0,0,0,0.14);
      --shima-panel: rgba(255,255,255,0.90);
    }

    body{
      position: relative;
      background: linear-gradient(180deg, var(--shima-ice-1), var(--shima-ice-2));
    }
    body::before{
      content:"";
      position: fixed; inset:0;
      z-index:-2;
      background:
        url("data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%27520%27%20height%3D%27520%27%20viewBox%3D%270%200%20520%20520%27%3E%0A%3Cdefs%3E%0A%3Cfilter%20id%3D%27b%27%20x%3D%27-20%25%27%20y%3D%27-20%25%27%20width%3D%27140%25%27%20height%3D%27140%25%27%3E%0A%3CfeGaussianBlur%20stdDeviation%3D%2710%27/%3E%0A%3C/filter%3E%0A%3C/defs%3E%0A%3Cg%20filter%3D%27url%28%23b%29%27%20opacity%3D%270.9%27%3E%0A%3Cpath%20d%3D%27M185%20318c-52-22-74-92-36-142%2034-45%20101-59%20150-29%2028%2017%2052%2047%2057%2080%205%2034-8%2069-33%2092%2028%209%2055%2028%2072%2057-42%208-87-3-121-27-31%2040-89%2057-137%2039%2019-17%2034-39%2048-70z%27%0A%20fill%3D%27rgba%28255%2C255%2C255%2C0.08%29%27/%3E%0A%3Ccircle%20cx%3D%27278%27%20cy%3D%27212%27%20r%3D%2710%27%20fill%3D%27rgba%28255%2C255%2C255%2C0.10%29%27/%3E%0A%3C/g%3E%0A%3C/svg%3E") no-repeat right 6% top 18% / 360px 360px,
        radial-gradient(900px 600p/* --- ShimaBuilder extra: tiny Shima-enaga face & feather whisper --- */
    /* --- ShimaBuilder extra: Elegant Shima-enaga mark (quiet & minimal) --- */
.shima-face{
  display:inline-block;
  width:32px; height:32px;
  border-radius:999px;
  background: rgba(255,255,255,0.97);
  border:1px solid rgba(207,232,255,0.95);
  box-shadow: 0 6px 18px rgba(0,0,0,0.10);
  position: relative;
  margin-right: 10px;
  vertical-align: -6px;
  flex: 0 0 auto;
  filter: saturate(0.95);
  transition: filter 180ms ease, box-shadow 180ms ease;
}
.shima-face::before, .shima-face::after{
  content:"";
  position:absolute;
  width:4px; height:4px;
  border-radius:999px;
  background: rgba(30,36,48,0.92);
  top: 12px;
}
.shima-face::before{ left: 10px; }
.shima-face::after{ right: 10px; }
/* tiny glossy highlight */
.shima-face i{
  display:none;
}
.shima-face:hover{
  filter: brightness(1.03) saturate(1.0);
  box-shadow: 0 8px 22px rgba(0,0,0,0.12);
}

    header{
      position: relative;
      overflow: hidden;
    }
    header::after{
      content:"";
      position:absolute;
      inset:-8px;
      pointer-events:none;
      opacity:0.08;
      background-repeat: repeat;
      background-size: 220px 220px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cg fill='none' stroke='%2394d1ff' stroke-width='2' stroke-linecap='round' opacity='0.9'%3E%3Cpath d='M30 70 C70 40, 120 40, 170 70'/%3E%3Cpath d='M45 74 C80 55, 120 55, 155 74'/%3E%3Cpath d='M60 78 C90 68, 120 68, 140 78'/%3E%3Cpath d='M105 40 C112 70, 112 100, 105 140'/%3E%3C/g%3E%3C/svg%3E");
      transform: rotate(-6deg);
    }

    button, .btn, input[type="button"], input[type="submit"]{
      border-radius: 12px;
      border: 1px solid rgba(207,232,255,0.8);
      box-shadow: 0 6px 18px rgba(0,0,0,0.10);
    }
    button:hover, .btn:hover{
      filter: brightness(1.03);
    }

    /* Subtle snow specks (static, non-interactive) */
    .shima-noise{
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      opacity: 0.06;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Ccircle cx='12' cy='28' r='1.1' fill='white'/%3E%3Ccircle cx='44' cy='72' r='0.9' fill='white'/%3E%3Ccircle cx='88' cy='40' r='1.0' fill='white'/%3E%3Ccircle cx='128' cy='98' r='0.8' fill='white'/%3E%3Ccircle cx='150' cy='18' r='1.0' fill='white'/%3E%3C/svg%3E");
    }

    h d='M105 40 C112 70, 112 100, 105 140'/%3E%3C/g%3E%3C/svg%3E");
      transform: rotate(-6deg);
    }

    button, .btn, input[type="button"], input[type="submit"]{
      border-radius: 12px;
      border: 1px solid rgba(207,232,255,0.8);
      box-shadow: 0 6px 18px rgba(0,0,0,0.10);
    }
    button:hover, .btn:hover{
      filter: brightness(1.03);
    }

    /* Subtle snow specks (static, non-interactive) */
    .shima-noise{
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      opacity: 0.06;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Ccircle cx='12' cy='28' r='1.1' fill='white'/%3E%3Ccircle cx='44' cy='72' r='0.9' fill='white'/%3E%3Ccircle cx='88' cy='40' r='1.0' fill='white'/%3E%3Ccircle cx='128' cy='98' r='0.8' fill='white'/%3E%3Ccircle cx='150' cy='18' r='1.0' fill='white'/%3E%3C/svg%3E");
    }

    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; }
    }

  </style>
</head>
<body>
  <div class="shima-noise" aria-hidden="true"></div>


  <header>
    <h1>
      <span class="shima-face" aria-hidden="true"></span>
      <span class="title-text">AI„Ç§„É©„Çπ„ÉàÁî® „Ç∑„Éû„Éì„É´„ÉÄ„Éº</span>
      <span class="title-icon">üïäÔ∏è</span>
    </h1>
    <div class="subtitle">Ultimate Prompt Generation Tool</div>
  </header>

  <div class="container">
    
    <div id="loading-wrapper" style="display:none;">
      <div class="loading-title">Loading‚Ä¶</div>
      <div class="progress-outer">
        <div id="progress-bar" class="progress-inner" style="width:0%;"></div>
      </div>
      <div id="progress-text" class="loading-text">Preparing‚Ä¶</div>
    </div>
<div id="log-wrapper">
      <div class="log-header">
        <div>
          <span class="meter success"><span id="lbl-success">ÊàêÂäü</span> <span id="success-count">0</span></span>
          <span class="meter fail"><span id="lbl-fail">Â§±Êïó</span> <span id="fail-count">0</span></span>
        </div>
        <div style="font-size: 0.85em;">
          <label><input type="checkbox" id="auto-scroll" checked> <span id="lbl-auto-scroll">„É≠„Ç∞Ëá™Âãï„Çπ„ÇØ„É≠„Éº„É´</span></label>
          <label style="margin-left:12px;"><input type="checkbox" id="simpleVisualizeToggle"> <span id="lbl-simple-visualize">ÁîüÊàêÂÜÖÂÆπ„ÅÆÁ∞°ÊòìÂèØË¶ñÂåñ</span></label>
          <button type="button" id="log-expand" class="reload-btn">Êã°Â§ß</button><button type="button" id="log-shrink" class="reload-btn" style="display:none;">Á∏ÆÂ∞è</button><button id="btn-reload" onclick="location.reload()" class="reload-btn">ÂÜçË™≠Ëæº</button>
        </div>
      </div>
      <div id="log" aria-hidden="true">Initializing...</div>
    </div>

    <div id="sections">
      <div id="list-quality_preset" class="section"></div>
      <div id="list-preset_packs" class="section"></div>
      <div id="list-expression" class="section"></div>
      <div id="list-pose" class="section"></div>
      <div id="list-hair" class="section"></div>
      <div id="list-attire" class="section"></div>
      <div id="list-background" class="section"></div>
      <div id="list-filter" class="section"></div>
      <div id="list-effect" class="section"></div>
      <div id="list-cinematic" class="section"></div>
      <div id="list-lighting" class="section"></div>
      <div id="list-faith" class="section"></div>
      <div id="list-presets" class="section"></div>

      <div id="list-preview_sync" class="section"></div>
      <div id="list-visualsync" class="section"></div>
    </div>
  </div>

  <div id="mini-ui-fixed">
    <div id="actions">
      <button id="genBtn" type="button">ÁîüÊàê (Generate)</button>
      <button id="translateBtn" type="button">Ë®≥„Ç¨„Ç§„Éâ</button> <button id="copyBtn" type="button" onclick="copyTagOutput()">„Ç≥„Éî„Éº</button>
      <button id="resetBtn" type="button">„É™„Çª„ÉÉ„Éà</button>
    </div>
    <textarea id="out" placeholder="„Åì„Åì„Å´ÁîüÊàê„Åï„Çå„Åü„Çø„Ç∞„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô..."></textarea>
<section id="aiSummaryThumb" class="ai-thumb" hidden></section>
<section id="aiSummaryHistory" class="ai-history" hidden>
  <div class="ai-history__head">
    <div class="ai-history__title">üóÇÔ∏è Â±•Ê≠¥„Çµ„Éû„É™„ÉºÔºàÁõ¥Ëøë10‰ª∂Ôºâ</div>
    <button id="aiHistoryClear" class="ai-thumb__btn" type="button">ÂÖ®Ê∂àÂéª</button>
  </div>
  <div id="aiHistoryList" class="ai-history__list"></div>
</section>

  </div>

  <script src="ext_manifest_loader.v1.js" data-ext></script>

  <script>
    function copyTagOutput() {
      const outEl = document.getElementById('out');
      const outText = outEl ? outEl.value : '';
      if(!outText) return;
      navigator.clipboard.writeText(outText).then(() => {
        const btn = document.getElementById('copyBtn');
        if(!btn) return;
        const t = (window.__i18n && typeof window.__i18n.t === 'function') ? window.__i18n.t : ((k,fb)=>fb||k);
        btn.textContent = t('ui.copy_done', '„Ç≥„Éî„ÉºÂÆå‰∫Ü!');
        setTimeout(() => { btn.textContent = t('ui.copy', '„Ç≥„Éî„Éº'); }, 1500);
      }).catch(err => { console.error("Copy failed", err); });
    }

    function generateTags() {
      // „Ç≥„Ç¢ÂÅ¥„ÅÆÁîüÊàê„É≠„Ç∏„ÉÉ„ÇØ„ÅåÂÑ™ÂÖà„Åï„Çå„Åæ„Åô
    }
    
    function resetTags() { } 
  </script>

<script>
(function(){
  const wrap = () => document.getElementById('log-wrapper');
  const btnExpand = () => document.getElementById('log-expand');
  const btnShrink = () => document.getElementById('log-shrink');
  function setFull(on){
    const w = wrap(); if(!w) return;
    if(on){
      w.classList.add('fullscreen');
      document.body.classList.add('log-fullscreen');
      if(btnExpand()) btnExpand().style.display='none';
      if(btnShrink()) btnShrink().style.display='';
      // keep scroll at bottom if auto-scroll is on
      const as = document.getElementById('auto-scroll');
      if(as && as.checked) w.querySelector('#log')?.scrollTo(0, 1e9);
    }else{
      w.classList.remove('fullscreen');
      document.body.classList.remove('log-fullscreen');
      if(btnExpand()) btnExpand().style.display='';
      if(btnShrink()) btnShrink().style.display='none';
    }
  }
  document.addEventListener('click', (e)=>{
    if(e.target && e.target.id==='log-expand'){ e.preventDefault(); setFull(true); }
    if(e.target && e.target.id==='log-shrink'){ e.preventDefault(); setFull(false); }
  });
  // ESC to shrink
  document.addEventListener('keydown',(e)=>{ if(e.key==='Escape'){ setFull(false); } });
})();
</script>



<script>
(function(){
  "use strict";
  // i18n apply hook (UI only)
  function applyI18n(){
    const i18n = window.__i18n;
    if(!i18n || typeof i18n.t !== "function") return;
    const t = i18n.t;

    const setText = (id, key, fallback) => {
      const el = document.getElementById(id);
      if(!el) return;
      el.textContent = t(key, fallback ?? el.textContent);
    };

    setText("genBtn", "ui.generate", "ÁîüÊàê (Generate)");
    setText("copyBtn", "ui.copy", "„Ç≥„Éî„Éº");
    setText("resetBtn", "ui.reset", "„É™„Çª„ÉÉ„Éà");
    setText("translateBtn", "ui.jp_view", "Ë®≥„Ç¨„Ç§„Éâ");

    const out = document.getElementById("out");
    if(out) out.placeholder = t("ui.output_placeholder", out.placeholder);

    const lblAuto = document.getElementById("lbl-auto-scroll");
    if(lblAuto) lblAuto.textContent = t("ui.log_autoscroll", lblAuto.textContent);

    const lblSucc = document.getElementById("lbl-success");
    if(lblSucc) lblSucc.textContent = t("ui.success", lblSucc.textContent);
    const lblFail = document.getElementById("lbl-fail");
    if(lblFail) lblFail.textContent = t("ui.fail", lblFail.textContent);

    setText("log-expand", "ui.log_expand", "Êã°Â§ß");
    setText("log-shrink", "ui.log_shrink", "Á∏ÆÂ∞è");
    setText("btn-reload", "ui.reload", "ÂÜçË™≠Ëæº");

    if (typeof window.__applyFloatingPanelI18n === "function") {
      window.__applyFloatingPanelI18n();
    }
  }

  window.__applyI18n = applyI18n;

  function bind(){
    const btn = document.getElementById("translateBtn");
    if(btn && !btn.__i18nBound){
      btn.__i18nBound = true;
      btn.addEventListener("click", () => {
        if(window.__i18n && typeof window.__i18n.toggleLang === "function"){
          window.__i18n.toggleLang();
        }else{
          // no-op
        }
      });
    }
    applyI18n();
    setTimeout(applyI18n, 250);
    setTimeout(applyI18n, 1200);
  }

  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", bind);
  }else{
    bind();
  }
})();
</script>

<script>
(function(){
  "use strict";
  function isDev(){
    try { return localStorage.getItem("BUILDER_DEV_MODE") === "true"; }
    catch(e){ return false; }
  }
  function apply(){
    const btn = document.getElementById("translateBtn");
    if(!btn) return;
    if(isDev()){
      btn.classList.remove("dev-only");
      btn.style.display = "";
    }else{
      btn.classList.add("dev-only");
      btn.style.display = "none";
    }
  }
  const run = () => { apply(); setTimeout(apply, 250); setTimeout(apply, 1200); };
  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", run);
  }else{
    run();
  }
})();
window.__simpleVisualizeEnabled=true;

// ---- Reset linkage for Simple Visualize ----
(function(){
  function hideSimpleVisualize(){
    var t=document.getElementById('aiSummaryThumb');
    var h=document.getElementById('aiSummaryHistory');
    if(t) t.hidden=true;
    if(h) h.hidden=true;
    window.__simpleVisualizeEnabled=false;
    try{ localStorage.setItem('simple_visualize_enabled_v1','0'); }catch(e){}
  }
  document.addEventListener('click',function(e){
    var el=e.target;
    if(!el) return;
    var txt=(el.textContent||'').trim();
    if(el.id==='btn-reset' || txt.indexOf('„É™„Çª„ÉÉ„Éà')!==-1){
      hideSimpleVisualize();
    }
  },true);
})();


// ---- Loading UI mode switch (Admin: log / User: progress) ----
(function(){
  "use strict";
  function isDev(){
    try { return localStorage.getItem("BUILDER_DEV_MODE") === "true"; }
    catch(e){ return false; }
  }
  function applyLoadingMode(){
    var logW = document.getElementById("log-wrapper");
    var loadW = document.getElementById("loading-wrapper");
    if(!logW || !loadW) return;
    if(isDev()){
      logW.style.display = "";
      loadW.style.display = "none";
    }else{
      logW.style.display = "none";
      loadW.style.display = "";
    }
  }
  var run = function(){ applyLoadingMode(); setTimeout(applyLoadingMode, 250); };
  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", run);
  }else{
    run();
  }
  window.__applyLoadingMode = applyLoadingMode;
})();

</script>
</body>
</html>

